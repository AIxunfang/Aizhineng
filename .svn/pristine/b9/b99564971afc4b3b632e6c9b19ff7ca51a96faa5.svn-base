<template>
   <el-row class="uploadpage">
     <el-col :span="24">
         <el-col :span='24'>
             <div class="navigationbar"> 
              <span class="navigationname">项目管理<i class="el-icon-arrow-right" aria-hidden="true"></i>
                   项目列表
              </span>
            </div>
      </el-col> 
      <el-col :span="24">
              <div class="projectaddbox  projectmodel">
                    <div class="prijectaddpic"  @click="addrouter"></div>
              </div>
 
               <template  v-for="(item,index) in projectdata"  >
                   <div  :key="item.id"    class="projectmodel">
                  <div  class="projectdiscrb">
                          <div class="projectdimg">
                            <img src="../../assets/img/matter.png" alt="文件logo" class="massterpic">
                         </div>
                         <div  class="projectdisright">
                            <div  class="projectName">{{item.projectNameZh}}</div>
                            <div class="projectdiecribetion"><span>项目描述:</span>{{item.projectDesc}}</div>
                               <div class="projectdiecribetion"><span>存储目录:</span>{{item.projectPublicPath}}</div>
                         </div>
                  </div>
                   <div class="projectbottom">
                         <div class="menukey">
                             <el-button  size="small"  icon="el-icon-edit-outline" @click="edititem(index)"  >编辑</el-button>
                        </div>
                          <div class="menukey">
                                  <el-button  size="small"  icon="el-icon-delete"  @click="delectproject(index)">删除</el-button>
                        </div>                        
                          <div class="menukey">
                             <el-button  size="small"  icon="el-icon-search" @click="Detailelook">详情</el-button>
                        </div>   
                   </div>
              </div>
               </template>
      </el-col>
     </el-col>
                 <div class="paagenumber">
                   <el-pagination
                        background
                        layout="prev, pager, next, total"
                        :page-size='pageSize'
                        @current-change="pageIndexChange"
                        :total="paggtatol">
                  </el-pagination>
              </div>
   </el-row>
</template>
<script>
import {projectlist,deleteprojectId} from "@/api/api"

export default {
        data(){
          return{
                currPage:1,
                pageSize:8,
                projectdata:[],//项目数组
                paggtatol:null,
          }
        },
        methods:{
                getprojectlist(){
                      var parms={
                            currPage:this.currPage,
                            pageSize:this.pageSize
                      }
                    projectlist(parms).then(res=>{
                          console.log("-----列表-----")
                          console.log(res)
                          if(res.data.code==0){
                                 this.projectdata=res.data.data.list
                                 this.paggtatol=res.data.data.total
                          }
                    })
                },
               addrouter(){//点击添加,路由跳转
                     this.$router.push('/AddProject')   
               },
               Detailelook(){//点击进详情页面
                     this.$router.push('/projectdetail')  
               },
              pageIndexChange(index){//翻页
                    this.currPage=index
                     console.log("fenyededede")
                     console.log(this.currPage)
                    this.getprojectlist()
                     
              },
              delectproject(index){//删除项目
                         console.log("删除")
                         console.log(index)
                       var parms={
                             projectId:this.projectdata[index].projectId
                       }   
                      this.$confirm('此操作将永久删除该项目, 是否继续?', '提示', {
                                                confirmButtonText: '确定',
                                                cancelButtonText: '取消',
                                                type: 'warning'
                                              }).then(() => {
                                              deleteprojectId(parms).then(res=>{
                                                            console.log(res)
                                                    if(res.data.code==0){
                                                                      this.$message({
                                                                        message: '删除成功',
                                                                        type: 'success'
                                                                      });  
                                                               this.getprojectlist()
                                                           }else{
                                                               this.$message.error('出现错误，删除失败');
                                                           }
                                                      })
                                              }).catch(() => {
                                                this.$message({
                                                  type: 'info',
                                                  message: '已取消删除'
                                                });          
                                              }); 
                    },
                 edititem(index){//编辑项目
                          this.$router.push({name:"AddProject",params:{id:this.projectdata[index],editjudge:false}})    
                   }



           },
        mounted(){
             this.getprojectlist()
        }
}
</script>
<style lang="scss" scoped>

    .uploadpage{
       .projectaddbox{
            line-height: 139px;
            text-align: center;
            .prijectaddpic{
                  display: inline-block;
                  width: 65px;
                  height: 65px;
                  background: url(../../assets/img/add.png);
                  vertical-align:middle;
                  cursor:pointer;
            }
       }
       .projectmodel{
              border: 1px solid #e4e4e4;
              margin:20px 0px 0px 20px;
              display: inline-block;
              float: left;
              width: 357px;
              height: 139px;
              border-radius: 5px;
              .projectdiscrb{
                   height: 82px;
                   border-bottom: 1px solid #e4e4e4;
                   .massterpic{
                      display: inline-block;
                      // vertical-align: middle;
                   }
                   .projectdimg{
                            display: inline-block;
                   }
                   .projectName{
                       margin-top: 5px;
                       display: inline-block;
                       font-family: "Microsoft YaHei";
                       color:#666666;
                       font-size:16px;
                       width:250px;
                   }
                   .projectdiecribetion{
                            display: inline-block;
                            width:250px;
                            font-size:14px;
                            color:#989898;
                            margin-top:5px;
                            text-overflow:ellipsis;//值为clip表示剪切，ellipsis时为显示省略号
                            overflow:hidden; 
                            white-space:nowrap;
                   }
                   .projectdisright{
                           display: inline-block;
                           width: 250px;
                           height: 83px;
                   }
              }
              .projectbottom{
                  height:57px;
                  width:100%;
                  .menukey{
                       width:115px;
                       display: inline-block;
                       height: 57px;
                       text-align: center;
                       line-height: 57px;
                       .el-button{
                         border: none;
                       }

                  }
              }

       }


    }

</style>

